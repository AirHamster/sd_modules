Ultralightweight J\+S\+ON parser in A\+N\+SI C.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md180}{}\doxysection{Table of contents}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md180}

\begin{DoxyItemize}
\item \href{\#license}{\texttt{ License}}
\item \href{\#usage}{\texttt{ Usage}}
\begin{DoxyItemize}
\item \href{\#welcome-to-cjson}{\texttt{ Welcome to c\+J\+S\+ON}}
\item \href{\#building}{\texttt{ Building}}
\begin{DoxyItemize}
\item \href{\#copying-the-source}{\texttt{ Copying the source}}
\item \href{\#cmake}{\texttt{ C\+Make}}
\item \href{\#makefile}{\texttt{ Makefile}}
\item \href{\#Vcpkg}{\texttt{ Vcpkg}}
\end{DoxyItemize}
\item \href{\#including-cjson}{\texttt{ Including c\+J\+S\+ON}}
\item \href{\#data-structure}{\texttt{ Data Structure}}
\item \href{\#working-with-the-data-structure}{\texttt{ Working with the data structure}}
\begin{DoxyItemize}
\item \href{\#basic-types}{\texttt{ Basic types}}
\item \href{\#arrays}{\texttt{ Arrays}}
\item \href{\#objects}{\texttt{ Objects}}
\end{DoxyItemize}
\item \href{\#parsing-json}{\texttt{ Parsing J\+S\+ON}}
\item \href{\#printing-json}{\texttt{ Printing J\+S\+ON}}
\item \href{\#example}{\texttt{ Example}}
\begin{DoxyItemize}
\item \href{\#printing}{\texttt{ Printing}}
\item \href{\#parsing}{\texttt{ Parsing}}
\end{DoxyItemize}
\item \href{\#caveats}{\texttt{ Caveats}}
\begin{DoxyItemize}
\item \href{\#zero-character}{\texttt{ Zero Character}}
\item \href{\#character-encoding}{\texttt{ Character Encoding}}
\item \href{\#c-standard}{\texttt{ C Standard}}
\item \href{\#floating-point-numbers}{\texttt{ Floating Point Numbers}}
\item \href{\#deep-nesting-of-arrays-and-objects}{\texttt{ Deep Nesting Of Arrays And Objects}}
\item \href{\#thread-safety}{\texttt{ Thread Safety}}
\item \href{\#case-sensitivity}{\texttt{ Case Sensitivity}}
\item \href{\#duplicate-object-members}{\texttt{ Duplicate Object Members}}
\end{DoxyItemize}
\item \href{\#enjoy-cjson}{\texttt{ Enjoy c\+J\+S\+O\+N!}}
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md181}{}\doxysection{License}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md181}
M\+IT License

\begin{quote}
Copyright (c) 2009-\/2017 Dave Gamble and \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} contributors

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \char`\"{}\+Software\char`\"{}), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions\+:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

T\+HE S\+O\+F\+T\+W\+A\+RE IS P\+R\+O\+V\+I\+D\+ED \char`\"{}\+A\+S I\+S\char`\"{}, W\+I\+T\+H\+O\+UT W\+A\+R\+R\+A\+N\+TY OF A\+NY K\+I\+ND, E\+X\+P\+R\+E\+SS OR I\+M\+P\+L\+I\+ED, I\+N\+C\+L\+U\+D\+I\+NG B\+UT N\+OT L\+I\+M\+I\+T\+ED TO T\+HE W\+A\+R\+R\+A\+N\+T\+I\+ES OF M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY, F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE A\+ND N\+O\+N\+I\+N\+F\+R\+I\+N\+G\+E\+M\+E\+NT. IN NO E\+V\+E\+NT S\+H\+A\+LL T\+HE A\+U\+T\+H\+O\+RS OR C\+O\+P\+Y\+R\+I\+G\+HT H\+O\+L\+D\+E\+RS BE L\+I\+A\+B\+LE F\+OR A\+NY C\+L\+A\+IM, D\+A\+M\+A\+G\+ES OR O\+T\+H\+ER L\+I\+A\+B\+I\+L\+I\+TY, W\+H\+E\+T\+H\+ER IN AN A\+C\+T\+I\+ON OF C\+O\+N\+T\+R\+A\+CT, T\+O\+RT OR O\+T\+H\+E\+R\+W\+I\+SE, A\+R\+I\+S\+I\+NG F\+R\+OM, O\+UT OF OR IN C\+O\+N\+N\+E\+C\+T\+I\+ON W\+I\+TH T\+HE S\+O\+F\+T\+W\+A\+RE OR T\+HE U\+SE OR O\+T\+H\+ER D\+E\+A\+L\+I\+N\+GS IN T\+HE S\+O\+F\+T\+W\+A\+RE. \end{quote}
\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md182}{}\doxysection{Usage}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md182}
\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md183}{}\doxysubsection{Welcome to c\+J\+S\+O\+N.}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md183}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} aims to be the dumbest possible parser that you can get your job done with. It\textquotesingle{}s a single file of C, and a single header file.

J\+S\+ON is described best here\+: \href{http://www.json.org/}{\texttt{ http\+://www.\+json.\+org/}} It\textquotesingle{}s like X\+ML, but fat-\/free. You use it to move data around, store things, or just generally represent your program\textquotesingle{}s state.

As a library, \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} exists to take away as much legwork as it can, but not get in your way. As a point of pragmatism (i.\+e. ignoring the truth), I\textquotesingle{}m going to say that you can use it in one of two modes\+: Auto and Manual. Let\textquotesingle{}s have a quick run-\/through.

I lifted some J\+S\+ON from this page\+: \href{http://www.json.org/fatfree.html}{\texttt{ http\+://www.\+json.\+org/fatfree.\+html}} That page inspired me to write \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}, which is a parser that tries to share the same philosophy as J\+S\+ON itself. Simple, dumb, out of the way.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md184}{}\doxysubsection{Building}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md184}
There are several ways to incorporate \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} into your project.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md185}{}\doxysubsubsection{copying the source}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md185}
Because the entire library is only one C file and one header file, you can just copy {\ttfamily \mbox{\hyperlink{c_j_s_o_n_8h_source}{c\+J\+S\+O\+N.\+h}}} and {\ttfamily c\+J\+S\+O\+N.\+c} to your projects source and start using it.

\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} is written in A\+N\+SI C (C89) in order to support as many platforms and compilers as possible.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md186}{}\doxysubsubsection{C\+Make}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md186}
With C\+Make, \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} supports a full blown build system. This way you get the most features. C\+Make with an equal or higher version than 2.\+8.\+5 is supported. With C\+Make it is recommended to do an out of tree build, meaning the compiled files are put in a directory separate from the source files. So in order to build \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} with C\+Make on a Unix platform, make a {\ttfamily build} directory and run C\+Make inside it.


\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir build}
\DoxyCodeLine{cd build}
\DoxyCodeLine{cmake ..}
\end{DoxyCode}


This will create a Makefile and a bunch of other files. You can then compile it\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{make}
\end{DoxyCode}


And install it with {\ttfamily make install} if you want. By default it installs the headers {\ttfamily /usr/local/include/cjson} and the libraries to {\ttfamily /usr/local/lib}. It also installs files for pkg-\/config to make it easier to detect and use an existing installation of C\+Make. And it installs C\+Make config files, that can be used by other C\+Make based projects to discover the library.

You can change the build process with a list of different options that you can pass to C\+Make. Turn them on with {\ttfamily On} and off with {\ttfamily Off}\+:


\begin{DoxyItemize}
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+C\+J\+S\+O\+N\+\_\+\+T\+E\+ST=On}\+: Enable building the tests. (on by default)
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+C\+J\+S\+O\+N\+\_\+\+U\+T\+I\+LS=On}\+: Enable building c\+J\+S\+O\+N\+\_\+\+Utils. (off by default)
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+T\+A\+R\+G\+E\+T\+\_\+\+E\+X\+P\+O\+RT=On}\+: Enable the export of C\+Make targets. Turn off if it makes problems. (on by default)
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+C\+U\+S\+T\+O\+M\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+F\+L\+A\+GS=On}\+: Enable custom compiler flags (currently for Clang, G\+CC and M\+S\+VC). Turn off if it makes problems. (on by default)
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+V\+A\+L\+G\+R\+I\+ND=On}\+: Run tests with \href{http://valgrind.org}{\texttt{ valgrind}}. (off by default)
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+S\+A\+N\+I\+T\+I\+Z\+E\+RS=On}\+: Compile \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} with \href{https://github.com/google/sanitizers/wiki/AddressSanitizer}{\texttt{ Address\+Sanitizer}} and \href{https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html}{\texttt{ Undefined\+Behavior\+Sanitizer}} enabled (if possible). (off by default)
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+S\+A\+F\+E\+\_\+\+S\+T\+A\+CK}\+: Enable the \href{https://clang.llvm.org/docs/SafeStack.html}{\texttt{ Safe\+Stack}} instrumentation pass. Currently only works with the Clang compiler. (off by default)
\item {\ttfamily -\/D\+B\+U\+I\+L\+D\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+L\+I\+BS=On}\+: Build the shared libraries. (on by default)
\item {\ttfamily -\/D\+B\+U\+I\+L\+D\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+A\+N\+D\+\_\+\+S\+T\+A\+T\+I\+C\+\_\+\+L\+I\+BS=On}\+: Build both shared and static libraries. (off by default)
\item {\ttfamily -\/D\+C\+M\+A\+K\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+\_\+\+P\+R\+E\+F\+IX=/usr}\+: Set a prefix for the installation.
\item {\ttfamily -\/D\+E\+N\+A\+B\+L\+E\+\_\+\+L\+O\+C\+A\+L\+ES=On}\+: Enable the usage of localeconv method. ( on by default )
\item {\ttfamily -\/D\+C\+J\+S\+O\+N\+\_\+\+O\+V\+E\+R\+R\+I\+D\+E\+\_\+\+B\+U\+I\+L\+D\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+L\+I\+BS=On}\+: Enable overriding the value of {\ttfamily B\+U\+I\+L\+D\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+L\+I\+BS} with {\ttfamily -\/D\+C\+J\+S\+O\+N\+\_\+\+B\+U\+I\+L\+D\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+L\+I\+BS}.
\end{DoxyItemize}

If you are packaging \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} for a distribution of Linux, you would probably take these steps for example\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir build}
\DoxyCodeLine{cd build}
\DoxyCodeLine{cmake .. -\/DENABLE\_CJSON\_UTILS=On -\/DENABLE\_CJSON\_TEST=Off -\/DCMAKE\_INSTALL\_PREFIX=/usr}
\DoxyCodeLine{make}
\DoxyCodeLine{make DESTDIR=\$pkgdir install}
\end{DoxyCode}


On Windows C\+Make is usually used to create a Visual Studio solution file by running it inside the Developer Command Prompt for Visual Studio, for exact steps follow the official documentation from C\+Make and Microsoft and use the online search engine of your choice. The descriptions of the the options above still generally apply, although not all of them work on Windows.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md187}{}\doxysubsubsection{Makefile}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md187}
{\bfseries{N\+O\+TE\+:}} This Method is deprecated. Use C\+Make if at all possible. Makefile support is limited to fixing bugs.

If you don\textquotesingle{}t have C\+Make available, but still have G\+NU make. You can use the makefile to build \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}\+:

Run this command in the directory with the source code and it will automatically compile static and shared libraries and a little test program (not the full test suite).


\begin{DoxyCode}{0}
\DoxyCodeLine{make all}
\end{DoxyCode}


If you want, you can install the compiled library to your system using {\ttfamily make install}. By default it will install the headers in {\ttfamily /usr/local/include/cjson} and the libraries in {\ttfamily /usr/local/lib}. But you can change this behavior by setting the {\ttfamily P\+R\+E\+F\+IX} and {\ttfamily D\+E\+S\+T\+D\+IR} variables\+: {\ttfamily make P\+R\+E\+F\+IX=/usr D\+E\+S\+T\+D\+IR=temp install}. And uninstall them with\+: {\ttfamily make P\+R\+E\+F\+IX=/usr D\+E\+S\+T\+D\+IR=temp uninstall}.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md188}{}\doxysubsubsection{Vcpkg}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md188}
You can download and install \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} using the \href{https://github.com/Microsoft/vcpkg}{\texttt{ vcpkg}} dependency manager\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{git clone https://github.com/Microsoft/vcpkg.git}
\DoxyCodeLine{cd vcpkg}
\DoxyCodeLine{./bootstrap-\/vcpkg.sh}
\DoxyCodeLine{./vcpkg integrate install}
\DoxyCodeLine{vcpkg install cjson}
\end{DoxyCode}


The \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} port in vcpkg is kept up to date by Microsoft team members and community contributors. If the version is out of date, please \href{https://github.com/Microsoft/vcpkg}{\texttt{ create an issue or pull request}} on the vcpkg repository.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md189}{}\doxysubsection{Including c\+J\+S\+ON}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md189}
If you installed it via C\+Make or the Makefile, you can include \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <cjson/cJSON.h>}}
\end{DoxyCode}
\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md190}{}\doxysubsection{Data Structure}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md190}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} represents J\+S\+ON data using the {\ttfamily \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}} struct data type\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{/* The cJSON structure: */}}
\DoxyCodeLine{\textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{structc_j_s_o_n}{cJSON}}}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keyword}{struct }\mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *next;}
\DoxyCodeLine{    \textcolor{keyword}{struct }\mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *prev;}
\DoxyCodeLine{    \textcolor{keyword}{struct }\mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *child;}
\DoxyCodeLine{    \textcolor{keywordtype}{int} type;}
\DoxyCodeLine{    \textcolor{keywordtype}{char} *valuestring;}
\DoxyCodeLine{    \textcolor{comment}{/* writing to valueint is DEPRECATED, use cJSON\_SetNumberValue instead */}}
\DoxyCodeLine{    \textcolor{keywordtype}{int} valueint;}
\DoxyCodeLine{    \textcolor{keywordtype}{double} valuedouble;}
\DoxyCodeLine{    \textcolor{keywordtype}{char} *string;}
\DoxyCodeLine{\} \mbox{\hyperlink{structc_j_s_o_n}{cJSON}};}
\end{DoxyCode}


An item of this type represents a J\+S\+ON value. The type is stored in {\ttfamily type} as a bit-\/flag ({\bfseries{this means that you cannot find out the type by just comparing the value of {\ttfamily type}}}).

To check the type of an item, use the corresponding {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is...} function. It does a {\ttfamily N\+U\+LL} check followed by a type check and returns a boolean value if the item is of this type.

The type can be one of the following\+:


\begin{DoxyItemize}
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Invalid} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Invalid})\+: Represents an invalid item that doesn\textquotesingle{}t contain any value. You automatically have this type if you set the item to all zero bytes.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+False} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+False})\+: Represents a {\ttfamily false} boolean value. You can also check for boolean values in general with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Bool}.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+True} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+True})\+: Represents a {\ttfamily true} boolean value. You can also check for boolean values in general with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Bool}.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+N\+U\+LL} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Null})\+: Represents a {\ttfamily null} value.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Number} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Number})\+: Represents a number value. The value is stored as a double in {\ttfamily valuedouble} and also in {\ttfamily valueint}. If the number is outside of the range of an integer, {\ttfamily I\+N\+T\+\_\+\+M\+AX} or {\ttfamily I\+N\+T\+\_\+\+M\+IN} are used for {\ttfamily valueint}.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+String} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+String})\+: Represents a string value. It is stored in the form of a zero terminated string in {\ttfamily valuestring}.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Array} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Array})\+: Represent an array value. This is implemented by pointing {\ttfamily child} to a linked list of {\ttfamily \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}} items that represent the values in the array. The elements are linked together using {\ttfamily next} and {\ttfamily prev}, where the first element has {\ttfamily prev == N\+U\+LL} and the last element {\ttfamily next == N\+U\+LL}.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Object} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Object})\+: Represents an object value. Objects are stored same way as an array, the only difference is that the items in the object store their keys in {\ttfamily string}.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Raw} (check with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Raw})\+: Represents any kind of J\+S\+ON that is stored as a zero terminated array of characters in {\ttfamily valuestring}. This can be used, for example, to avoid printing the same static J\+S\+ON over and over again to save performance. \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} will never create this type when parsing. Also note that \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} doesn\textquotesingle{}t check if it is valid J\+S\+ON.
\end{DoxyItemize}

Additionally there are the following two flags\+:


\begin{DoxyItemize}
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Reference}\+: Specifies that the item that {\ttfamily child} points to and/or {\ttfamily valuestring} is not owned by this item, it is only a reference. So {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete} and other functions will only deallocate this item, not it\textquotesingle{}s children/valuestring.
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+String\+Is\+Const}\+: This means that {\ttfamily string} points to a constant string. This means that {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete} and other functions will not try to deallocate {\ttfamily string}.
\end{DoxyItemize}\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md191}{}\doxysubsection{Working with the data structure}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md191}
For every value type there is a {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create...} function that can be used to create an item of that type. All of these will allocate a {\ttfamily \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}} struct that can later be deleted with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}. Note that you have to delete them at some point, otherwise you will get a memory leak. {\bfseries{Important}}\+: If you have added an item to an array or an object already, you {\bfseries{mustn\textquotesingle{}t}} delete it with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}. Adding it to an array or object transfers its ownership so that when that array or object is deleted, it gets deleted as well.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md192}{}\doxysubsubsection{Basic types}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md192}

\begin{DoxyItemize}
\item {\bfseries{null}} is created with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+Null}
\item {\bfseries{booleans}} are created with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+True}, {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+False} or {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+Bool}
\item {\bfseries{numbers}} are created with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+Number}. This will set both {\ttfamily valuedouble} and {\ttfamily valueint}. If the number is outside of the range of an integer, {\ttfamily I\+N\+T\+\_\+\+M\+AX} or {\ttfamily I\+N\+T\+\_\+\+M\+IN} are used for {\ttfamily valueint}
\item {\bfseries{strings}} are created with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+String} (copies the string) or with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+String\+Reference} (directly points to the string. This means that {\ttfamily valuestring} won\textquotesingle{}t be deleted by {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete} and you are responsible for it\textquotesingle{}s lifetime, useful for constants)
\end{DoxyItemize}\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md193}{}\doxysubsubsection{Arrays}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md193}
You can create an empty array with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+Array}. {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+Array\+Reference} can be used to create an array that doesn\textquotesingle{}t \char`\"{}own\char`\"{} its content, so its content doesn\textquotesingle{}t get deleted by {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}.

To add items to an array, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Add\+Item\+To\+Array} to append items to the end. Using {\ttfamily c\+J\+S\+O\+N\+\_\+\+Add\+Item\+Reference\+To\+Array} an element can be added as a reference to another item, array or string. This means that {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete} will not delete that items {\ttfamily child} or {\ttfamily valuestring} properties, so no double frees are occurring if they are already used elsewhere. To insert items in the middle, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Insert\+Item\+In\+Array}. It will insert an item at the given 0 based index and shift all the existing items to the right.

If you want to take an item out of an array at a given index and continue using it, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Detach\+Item\+From\+Array}, it will return the detached item, so be sure to assign it to a pointer, otherwise you will have a memory leak.

Deleting items is done with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete\+Item\+From\+Array}. It works like {\ttfamily c\+J\+S\+O\+N\+\_\+\+Detach\+Item\+From\+Array}, but deletes the detached item via {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}.

You can also replace an item in an array in place. Either with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Replace\+Item\+In\+Array} using an index or with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Replace\+Item\+Via\+Pointer} given a pointer to an element. {\ttfamily c\+J\+S\+O\+N\+\_\+\+Replace\+Item\+Via\+Pointer} will return {\ttfamily 0} if it fails. What this does internally is to detach the old item, delete it and insert the new item in its place.

To get the size of an array, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Array\+Size}. Use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Array\+Item} to get an element at a given index.

Because an array is stored as a linked list, iterating it via index is inefficient ({\ttfamily O(nÂ²)}), so you can iterate over an array using the {\ttfamily c\+J\+S\+O\+N\+\_\+\+Array\+For\+Each} macro in {\ttfamily O(n)} time complexity.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md194}{}\doxysubsubsection{Objects}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md194}
You can create an empty object with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+Object}. {\ttfamily c\+J\+S\+O\+N\+\_\+\+Create\+Object\+Reference} can be used to create an object that doesn\textquotesingle{}t \char`\"{}own\char`\"{} its content, so its content doesn\textquotesingle{}t get deleted by {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}.

To add items to an object, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Add\+Item\+To\+Object}. Use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Add\+Item\+To\+Object\+CS} to add an item to an object with a name that is a constant or reference (key of the item, {\ttfamily string} in the {\ttfamily \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}} struct), so that it doesn\textquotesingle{}t get freed by {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}. Using {\ttfamily c\+J\+S\+O\+N\+\_\+\+Add\+Item\+Reference\+To\+Array} an element can be added as a reference to another object, array or string. This means that {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete} will not delete that items {\ttfamily child} or {\ttfamily valuestring} properties, so no double frees are occurring if they are already used elsewhere.

If you want to take an item out of an object, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Detach\+Item\+From\+Object\+Case\+Sensitive}, it will return the detached item, so be sure to assign it to a pointer, otherwise you will have a memory leak.

Deleting items is done with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete\+Item\+From\+Object\+Case\+Sensitive}. It works like {\ttfamily c\+J\+S\+O\+N\+\_\+\+Detach\+Item\+From\+Object\+Case\+Sensitive} followed by {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}.

You can also replace an item in an object in place. Either with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Replace\+Item\+In\+Object\+Case\+Sensitive} using a key or with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Replace\+Item\+Via\+Pointer} given a pointer to an element. {\ttfamily c\+J\+S\+O\+N\+\_\+\+Replace\+Item\+Via\+Pointer} will return {\ttfamily 0} if it fails. What this does internally is to detach the old item, delete it and insert the new item in its place.

To get the size of an object, you can use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Array\+Size}, this works because internally objects are stored as arrays.

If you want to access an item in an object, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Object\+Item\+Case\+Sensitive}.

To iterate over an object, you can use the {\ttfamily c\+J\+S\+O\+N\+\_\+\+Array\+For\+Each} macro the same way as for arrays.

\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} also provides convenient helper functions for quickly creating a new item and adding it to an object, like {\ttfamily c\+J\+S\+O\+N\+\_\+\+Add\+Null\+To\+Object}. They return a pointer to the new item or {\ttfamily N\+U\+LL} if they failed.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md195}{}\doxysubsection{Parsing J\+S\+ON}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md195}
Given some J\+S\+ON in a zero terminated string, you can parse it with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Parse}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *json = cJSON\_Parse(\textcolor{keywordtype}{string});}
\end{DoxyCode}


It will parse the J\+S\+ON and allocate a tree of {\ttfamily \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}} items that represents it. Once it returns, you are fully responsible for deallocating it after use with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Delete}.

The allocator used by {\ttfamily c\+J\+S\+O\+N\+\_\+\+Parse} is {\ttfamily malloc} and {\ttfamily free} by default but can be changed (globally) with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Init\+Hooks}.

If an error occurs a pointer to the position of the error in the input string can be accessed using {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Error\+Ptr}. Note though that this can produce race conditions in multithreading scenarios, in that case it is better to use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Parse\+With\+Opts} with {\ttfamily return\+\_\+parse\+\_\+end}. By default, characters in the input string that follow the parsed J\+S\+ON will not be considered as an error.

If you want more options, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Parse\+With\+Opts(const char $\ast$value, const char $\ast$$\ast$return\+\_\+parse\+\_\+end, c\+J\+S\+O\+N\+\_\+bool require\+\_\+null\+\_\+terminated)}. {\ttfamily return\+\_\+parse\+\_\+end} returns a pointer to the end of the J\+S\+ON in the input string or the position that an error occurs at (thereby replacing {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Error\+Ptr} in a thread safe way). {\ttfamily require\+\_\+null\+\_\+terminated}, if set to {\ttfamily 1} will make it an error if the input string contains data after the J\+S\+ON.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md196}{}\doxysubsection{Printing J\+S\+ON}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md196}
Given a tree of {\ttfamily \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}}} items, you can print them as a string using {\ttfamily c\+J\+S\+O\+N\+\_\+\+Print}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{char} *\textcolor{keywordtype}{string} = cJSON\_Print(json);}
\end{DoxyCode}


It will allocate a string and print a J\+S\+ON representation of the tree into it. Once it returns, you are fully responsible for deallocating it after use with your allocator. (usually {\ttfamily free}, depends on what has been set with {\ttfamily c\+J\+S\+O\+N\+\_\+\+Init\+Hooks}).

{\ttfamily c\+J\+S\+O\+N\+\_\+\+Print} will print with whitespace for formatting. If you want to print without formatting, use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Print\+Unformatted}.

If you have a rough idea of how big your resulting string will be, you can use {\ttfamily c\+J\+S\+O\+N\+\_\+\+Print\+Buffered(const c\+J\+S\+O\+N $\ast$item, int prebuffer, c\+J\+S\+O\+N\+\_\+bool fmt)}. {\ttfamily fmt} is a boolean to turn formatting with whitespace on and off. {\ttfamily prebuffer} specifies the first buffer size to use for printing. {\ttfamily c\+J\+S\+O\+N\+\_\+\+Print} currently uses 256 bytes for it\textquotesingle{}s first buffer size. Once printing runs out of space, a new buffer is allocated and the old gets copied over before printing is continued.

These dynamic buffer allocations can be completely avoided by using {\ttfamily c\+J\+S\+O\+N\+\_\+\+Print\+Preallocated(c\+J\+S\+O\+N $\ast$item, char $\ast$buffer, const int length, const c\+J\+S\+O\+N\+\_\+bool format)}. It takes a buffer to a pointer to print to and it\textquotesingle{}s length. If the length is reached, printing will fail and it returns {\ttfamily 0}. In case of success, {\ttfamily 1} is returned. Note that you should provide 5 bytes more than is actually needed, because \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} is not 100\% accurate in estimating if the provided memory is enough.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md197}{}\doxysubsection{Example}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md197}
In this example we want to build and parse the following J\+S\+ON\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{    "name": "Awesome 4K",}
\DoxyCodeLine{    "resolutions": [}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            "width": 1280,}
\DoxyCodeLine{            "height": 720}
\DoxyCodeLine{        \},}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            "width": 1920,}
\DoxyCodeLine{            "height": 1080}
\DoxyCodeLine{        \},}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            "width": 3840,}
\DoxyCodeLine{            "height": 2160}
\DoxyCodeLine{        \}}
\DoxyCodeLine{    ]}
\DoxyCodeLine{\}}
\end{DoxyCode}
\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md198}{}\doxysubsubsection{Printing}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md198}
Let\textquotesingle{}s build the above J\+S\+ON and print it to a string\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//create a monitor with a list of supported resolutions}}
\DoxyCodeLine{\textcolor{comment}{//NOTE: Returns a heap allocated string, you are required to free it after use.}}
\DoxyCodeLine{\textcolor{keywordtype}{char} *create\_monitor(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} resolution\_numbers[3][2] = \{}
\DoxyCodeLine{        \{1280, 720\},}
\DoxyCodeLine{        \{1920, 1080\},}
\DoxyCodeLine{        \{3840, 2160\}}
\DoxyCodeLine{    \};}
\DoxyCodeLine{    \textcolor{keywordtype}{char} *\textcolor{keywordtype}{string} = NULL;}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *name = NULL;}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *resolutions = NULL;}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *resolution = NULL;}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *width = NULL;}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *height = NULL;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} index = 0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *monitor = cJSON\_CreateObject();}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (monitor == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    name = cJSON\_CreateString(\textcolor{stringliteral}{"Awesome 4K"});}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (name == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{comment}{/* after creation was successful, immediately add it to the monitor,}}
\DoxyCodeLine{\textcolor{comment}{     * thereby transferring ownership of the pointer to it */}}
\DoxyCodeLine{    cJSON\_AddItemToObject(monitor, \textcolor{stringliteral}{"name"}, name);}
\DoxyCodeLine{}
\DoxyCodeLine{    resolutions = cJSON\_CreateArray();}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (resolutions == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    cJSON\_AddItemToObject(monitor, \textcolor{stringliteral}{"resolutions"}, resolutions);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (index = 0; index < (\textcolor{keyword}{sizeof}(resolution\_numbers) / (2 * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}))); ++index)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        resolution = cJSON\_CreateObject();}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (resolution == NULL)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{        cJSON\_AddItemToArray(resolutions, resolution);}
\DoxyCodeLine{}
\DoxyCodeLine{        width = cJSON\_CreateNumber(resolution\_numbers[index][0]);}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (width == NULL)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{        cJSON\_AddItemToObject(resolution, \textcolor{stringliteral}{"width"}, width);}
\DoxyCodeLine{}
\DoxyCodeLine{        height = cJSON\_CreateNumber(resolution\_numbers[index][1]);}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (height == NULL)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{        cJSON\_AddItemToObject(resolution, \textcolor{stringliteral}{"height"}, height);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{string} = cJSON\_Print(monitor);}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\textcolor{keywordtype}{string} == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        fprintf(stderr, \textcolor{stringliteral}{"Failed to print monitor.\(\backslash\)n"});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{end:}
\DoxyCodeLine{    cJSON\_Delete(monitor);}
\DoxyCodeLine{    \textcolor{keywordflow}{return} string;}
\DoxyCodeLine{\}}
\end{DoxyCode}


Alternatively we can use the {\ttfamily c\+J\+S\+O\+N\+\_\+\+Add...To\+Object} helper functions to make our lifes a little easier\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//NOTE: Returns a heap allocated string, you are required to free it after use.}}
\DoxyCodeLine{\textcolor{keywordtype}{char} *create\_monitor\_with\_helpers(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} resolution\_numbers[3][2] = \{}
\DoxyCodeLine{        \{1280, 720\},}
\DoxyCodeLine{        \{1920, 1080\},}
\DoxyCodeLine{        \{3840, 2160\}}
\DoxyCodeLine{    \};}
\DoxyCodeLine{    \textcolor{keywordtype}{char} *\textcolor{keywordtype}{string} = NULL;}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *resolutions = NULL;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} index = 0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *monitor = cJSON\_CreateObject();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (cJSON\_AddStringToObject(monitor, \textcolor{stringliteral}{"name"}, \textcolor{stringliteral}{"Awesome 4K"}) == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    resolutions = cJSON\_AddArrayToObject(monitor, \textcolor{stringliteral}{"resolutions"});}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (resolutions == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (index = 0; index < (\textcolor{keyword}{sizeof}(resolution\_numbers) / (2 * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}))); ++index)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *resolution = cJSON\_CreateObject();}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (cJSON\_AddNumberToObject(resolution, \textcolor{stringliteral}{"width"}, resolution\_numbers[index][0]) == NULL)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (cJSON\_AddNumberToObject(resolution, \textcolor{stringliteral}{"height"}, resolution\_numbers[index][1]) == NULL)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{}
\DoxyCodeLine{        cJSON\_AddItemToArray(resolutions, resolution);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{string} = cJSON\_Print(monitor);}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\textcolor{keywordtype}{string} == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        fprintf(stderr, \textcolor{stringliteral}{"Failed to print monitor.\(\backslash\)n"});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{end:}
\DoxyCodeLine{    cJSON\_Delete(monitor);}
\DoxyCodeLine{    \textcolor{keywordflow}{return} string;}
\DoxyCodeLine{\}}
\end{DoxyCode}
\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md199}{}\doxysubsubsection{Parsing}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md199}
In this example we will parse a J\+S\+ON in the above format and check if the monitor supports a Full HD resolution while printing some diagnostic output\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{/* return 1 if the monitor supports full hd, 0 otherwise */}}
\DoxyCodeLine{\textcolor{keywordtype}{int} supports\_full\_hd(\textcolor{keyword}{const} \textcolor{keywordtype}{char} * \textcolor{keyword}{const} monitor)}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keyword}{const} \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *resolution = NULL;}
\DoxyCodeLine{    \textcolor{keyword}{const} \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *resolutions = NULL;}
\DoxyCodeLine{    \textcolor{keyword}{const} \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *name = NULL;}
\DoxyCodeLine{    \textcolor{keywordtype}{int} status = 0;}
\DoxyCodeLine{    \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *monitor\_json = cJSON\_Parse(monitor);}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (monitor\_json == NULL)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \textcolor{keyword}{const} \textcolor{keywordtype}{char} *error\_ptr = cJSON\_GetErrorPtr();}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (error\_ptr != NULL)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            fprintf(stderr, \textcolor{stringliteral}{"Error before: \%s\(\backslash\)n"}, error\_ptr);}
\DoxyCodeLine{        \}}
\DoxyCodeLine{        status = 0;}
\DoxyCodeLine{        \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    name = cJSON\_GetObjectItemCaseSensitive(monitor\_json, \textcolor{stringliteral}{"name"});}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (cJSON\_IsString(name) \&\& (name-\/>valuestring != NULL))}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        printf(\textcolor{stringliteral}{"Checking monitor \(\backslash\)"\%s\(\backslash\)"\(\backslash\)n"}, name-\/>valuestring);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    resolutions = cJSON\_GetObjectItemCaseSensitive(monitor\_json, \textcolor{stringliteral}{"resolutions"});}
\DoxyCodeLine{    cJSON\_ArrayForEach(resolution, resolutions)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *width = cJSON\_GetObjectItemCaseSensitive(resolution, \textcolor{stringliteral}{"width"});}
\DoxyCodeLine{        \mbox{\hyperlink{structc_j_s_o_n}{cJSON}} *height = cJSON\_GetObjectItemCaseSensitive(resolution, \textcolor{stringliteral}{"height"});}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (!cJSON\_IsNumber(width) || !cJSON\_IsNumber(height))}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            status = 0;}
\DoxyCodeLine{            \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{keywordflow}{if} ((width-\/>valuedouble == 1920) \&\& (height-\/>valuedouble == 1080))}
\DoxyCodeLine{        \{}
\DoxyCodeLine{            status = 1;}
\DoxyCodeLine{            \textcolor{keywordflow}{goto} end;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{end:}
\DoxyCodeLine{    cJSON\_Delete(monitor\_json);}
\DoxyCodeLine{    \textcolor{keywordflow}{return} status;}
\DoxyCodeLine{\}}
\end{DoxyCode}


Note that there are no N\+U\+LL checks except for the result of {\ttfamily c\+J\+S\+O\+N\+\_\+\+Parse} because {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Object\+Item\+Case\+Sensitive} checks for {\ttfamily N\+U\+LL} inputs already, so a {\ttfamily N\+U\+LL} value is just propagated and {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+Number} and {\ttfamily c\+J\+S\+O\+N\+\_\+\+Is\+String} return {\ttfamily 0} if the input is {\ttfamily N\+U\+LL}.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md200}{}\doxysubsection{Caveats}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md200}
\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md201}{}\doxysubsubsection{Zero Character}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md201}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} doesn\textquotesingle{}t support strings that contain the zero character `'\textbackslash{}0\textquotesingle{}{\ttfamily or}\textbackslash{}u0000\`{}. This is impossible with the current A\+PI because strings are zero terminated.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md202}{}\doxysubsubsection{Character Encoding}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md202}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} only supports U\+T\+F-\/8 encoded input. In most cases it doesn\textquotesingle{}t reject invalid U\+T\+F-\/8 as input though, it just propagates it through as is. As long as the input doesn\textquotesingle{}t contain invalid U\+T\+F-\/8, the output will always be valid U\+T\+F-\/8.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md203}{}\doxysubsubsection{C Standard}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md203}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} is written in A\+N\+SI C (or C89, C90). If your compiler or C library doesn\textquotesingle{}t follow this standard, correct behavior is not guaranteed.

N\+O\+TE\+: A\+N\+SI C is not C++ therefore it shouldn\textquotesingle{}t be compiled with a C++ compiler. You can compile it with a C compiler and link it with your C++ code however. Although compiling with a C++ compiler might work, correct behavior is not guaranteed.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md204}{}\doxysubsubsection{Floating Point Numbers}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md204}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} does not officially support any {\ttfamily double} implementations other than I\+E\+E\+E754 double precision floating point numbers. It might still work with other implementations but bugs with these will be considered invalid.

The maximum length of a floating point literal that \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} supports is currently 63 characters.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md205}{}\doxysubsubsection{Deep Nesting Of Arrays And Objects}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md205}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} doesn\textquotesingle{}t support arrays and objects that are nested too deeply because this would result in a stack overflow. To prevent this \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} limits the depth to {\ttfamily C\+J\+S\+O\+N\+\_\+\+N\+E\+S\+T\+I\+N\+G\+\_\+\+L\+I\+M\+IT} which is 1000 by default but can be changed at compile time.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md206}{}\doxysubsubsection{Thread Safety}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md206}
In general \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} is {\bfseries{not thread safe}}.

However it is thread safe under the following conditions\+:


\begin{DoxyItemize}
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Error\+Ptr} is never used (the {\ttfamily return\+\_\+parse\+\_\+end} parameter of {\ttfamily c\+J\+S\+O\+N\+\_\+\+Parse\+With\+Opts} can be used instead)
\item {\ttfamily c\+J\+S\+O\+N\+\_\+\+Init\+Hooks} is only ever called before using \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} in any threads.
\item {\ttfamily setlocale} is never called before all calls to \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} functions have returned.
\end{DoxyItemize}\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md207}{}\doxysubsubsection{Case Sensitivity}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md207}
When \mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} was originally created, it didn\textquotesingle{}t follow the J\+S\+ON standard and didn\textquotesingle{}t make a distinction between uppercase and lowercase letters. If you want the correct, standard compliant, behavior, you need to use the {\ttfamily Case\+Sensitive} functions where available.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md208}{}\doxysubsubsection{Duplicate Object Members}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md208}
\mbox{\hyperlink{structc_j_s_o_n}{c\+J\+S\+ON}} supports parsing and printing J\+S\+ON that contains objects that have multiple members with the same name. {\ttfamily c\+J\+S\+O\+N\+\_\+\+Get\+Object\+Item\+Case\+Sensitive} however will always only return the first one.\hypertarget{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md209}{}\doxysection{Enjoy c\+J\+S\+O\+N!}\label{md_c_j_s_o_n__r_e_a_d_m_e_autotoc_md209}

\begin{DoxyItemize}
\item Dave Gamble (original author)
\item Max Bruckner (current maintainer)
\item and the other c\+J\+S\+ON contributors 
\end{DoxyItemize}